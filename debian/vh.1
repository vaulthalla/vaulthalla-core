'\" t
.\" Automatically generated by Pandoc 3.1.3
.\"
.\" Define V font for inline verbatim, using C font in formats
.\" that render this, and otherwise B font.
.ie "\f[CB]x\f[]"x" \{\
. ftr V B
. ftr VI BI
. ftr VB B
. ftr VBI BI
.\}
.el \{\
. ftr V CR
. ftr VI CI
. ftr VB CB
. ftr VBI CBI
.\}
.TH "vh" "1" "August 2025" "Vaulthalla CLI" ""
.hy
.SH NAME
.PP
vh, vaulthalla - command-line interface for the Vaulthalla server daemon
.SH SYNOPSIS
.PP
\f[B]vh\f[R] [\f[I]global-options\f[R]] \f[I]command\f[R]
[\f[I]args\f[R]]
.SH DESCRIPTION
.PP
The \f[V]vh\f[R] tool (also accessible via the \f[V]vaulthalla\f[R]
symlink) lets you interact with a running Vaulthalla server daemon.
It provides administrative control over users, groups, roles, storage
vaults, synchronization tasks, and API keys.
Most commands accept either human-readable names or numeric IDs; where
names could be ambiguous, you can disambiguate with an additional flag
(e.g., \f[V]--owner\f[R] for vaults).
.PP
Use \f[V]vh <command> --help\f[R] to see command-specific help.
.SH GLOBAL OPTIONS
.IP \[bu] 2
\f[V]-h\f[R], \f[V]--help\f[R]
.PD 0
.P
.PD
Show top-level help.
.IP \[bu] 2
\f[V]-v\f[R], \f[V]--version\f[R]
.PD 0
.P
.PD
Show version information.
.SH COMMAND LIST
.PP
.TS
tab(@);
l l l.
T{
NAME
T}@T{
ALIASES
T}@T{
DESCRIPTION
T}
_
T{
\f[V]api-key\f[R]
T}@T{
\f[V]--ak\f[R], \f[V]--api\f[R]
T}@T{
Manage a single API key
T}
T{
\f[V]api-keys\f[R]
T}@T{
\[em]
T}@T{
List API keys
T}
T{
\f[V]group\f[R]
T}@T{
\f[V]-g\f[R]
T}@T{
Manage a single group
T}
T{
\f[V]groups\f[R]
T}@T{
\f[V]--lg\f[R]
T}@T{
List groups
T}
T{
\f[V]help\f[R]
T}@T{
\f[V]?\f[R], \f[V]-h\f[R], \f[V]--help\f[R]
T}@T{
Show help info
T}
T{
\f[V]roles\f[R]
T}@T{
\[em]
T}@T{
Manage roles
T}
T{
\f[V]user\f[R]
T}@T{
\f[V]-u\f[R]
T}@T{
Manage a single user
T}
T{
\f[V]users\f[R]
T}@T{
\[em]
T}@T{
List users
T}
T{
\f[V]vault\f[R]
T}@T{
\[em]
T}@T{
Manage a single vault
T}
T{
\f[V]vaults\f[R]
T}@T{
\f[V]--ls\f[R]
T}@T{
List vaults
T}
T{
\f[V]version\f[R]
T}@T{
\f[V]-v\f[R], \f[V]--version\f[R]
T}@T{
Show version information
T}
T{
\f[V]sync\f[R]
T}@T{
\[em]
T}@T{
Control background sync tasks
T}
.TE
.SH SUBCOMMANDS
.SS users / user
.IP
.nf
\f[C]
user [create | new] --name <name> --role <role> [--email <email>] [--linux-uid <uid>]
user [delete | rm] <name>
user [info | get] <name>
user [update | set] <name> [--name <name>] [--email <email>] [--role <role>] [--linux-uid <uid>]
\f[R]
.fi
.IP \[bu] 2
\f[V]user create\f[R] creates a new user with the given name, role, and
optional email/Linux UID.
.IP \[bu] 2
\f[V]user delete\f[R] removes a user by name.
.IP \[bu] 2
\f[V]user info\f[R] shows details.
.IP \[bu] 2
\f[V]user update\f[R] changes name/email/role/Linux UID.
.SS groups / group
.IP
.nf
\f[C]
groups [list]
group create <name> [--desc <description>] [--linux-gid <id>]
group delete <name> [--owner-id <id>]
group info <name | id>
group update <name | id> [--name <new_name>] [--desc <description>] [--linux-gid <id>]
group add-user <group_name | gid> <user_name | uid>
group remove-user <group_name | gid> <user_name | uid>
group list-users <group_name | gid> [--owner-id <id>]
\f[R]
.fi
.PP
Manage POSIX-style groups and membership.
Use names or IDs for both groups and users.
.SS vaults / vault
.IP
.nf
\f[C]
=== Vault Creation ===
vault create <name> --local
    [--on-sync-conflict <overwrite | keep_both | ask>]
    [--desc <text>] [--quota <size(T | G | M | B)> | unlimited]
    [--owner <id | name>]

vault create <name> --s3
    --api-key <name | id> --bucket <name>
    [--sync-strategy <cache | sync | mirror>]
    [--on-sync-conflict <keep_local | keep_remote | ask>]
    [--desc <text>] [--quota <size(T | G | M | B)> | unlimited]
    [--owner <id | name>]

=== Vault Update ===
vault (update | set) <id>
    [--api-key <name | id>] [--bucket <name>]
    [--sync-strategy <cache | sync | mirror>]
    [--on-sync-conflict <overwrite | keep_both | ask | keep_local | keep_remote>]
    [--desc <text>] [--quota <size(T | G | M | B)> | unlimited]
    [--owner <id | name>]

vault (update | set) <name> <owner>
    [--api-key <name | id>] [--bucket <name>]
    [--sync-strategy <cache | sync | mirror>]
    [--on-sync-conflict <overwrite | keep_both | ask | keep_local | keep_remote>]
    [--desc <text>] [--quota <size(T | G | M | B)> | unlimited]
    [--owner <id | name>]

=== Common Commands ===
vault delete <id>
vault delete <name> --owner <id | name>
vault info   <id>
vault info   <name> [--owner <id | name>]
vault assign <id> <role_id> --[uid | gid | user | group] <id | name>
vault assign <name> <role_id> --[uid | gid | user | group] <id | name> --owner <id | name>

=== Encryption Key Management ===
vault keys export  <vault_id | name | all>  [--recipient <fingerprint>] [--output <file>] [--owner <id | name>]
vault keys rotate  <vault_id | name | all>  [--owner <id | name>]
vault keys inspect <vault_id | name>        [--owner <id | name>]
\f[R]
.fi
.IP \[bu] 2
\f[V]--sync-strategy\f[R]:
.RS 2
.IP \[bu] 2
\f[V]cache\f[R]: keep a local cache fronting remote storage.
.IP \[bu] 2
\f[V]sync\f[R]: two-way file synchronization.
.IP \[bu] 2
\f[V]mirror\f[R]: one-way mirror of remote to local.
.RE
.IP \[bu] 2
\f[V]--on-sync-conflict\f[R]:
.RS 2
.IP \[bu] 2
Local: \f[V]overwrite\f[R], \f[V]keep_both\f[R], \f[V]ask\f[R]
.IP \[bu] 2
Remote/S3 context: \f[V]keep_local\f[R], \f[V]keep_remote\f[R],
\f[V]ask\f[R]
.RE
.IP \[bu] 2
\f[V]--quota\f[R] accepts sizes like \f[V]500G\f[R], \f[V]2T\f[R],
\f[V]100M\f[R].
Use \f[V]unlimited\f[R] to remove quotas.
.IP \[bu] 2
\f[V]vault assign\f[R] attaches a \f[B]vault role\f[R] (see
\f[I]roles\f[R]) to a subject:
.RS 2
.IP \[bu] 2
Subject selectors: \f[V]--uid\f[R] / \f[V]--user\f[R] for users;
\f[V]--gid\f[R] / \f[V]--group\f[R] for groups.
.RE
.IP \[bu] 2
\f[V]--owner\f[R] is required when a vault name is ambiguous or
duplicated across owners.
.SS roles
.IP
.nf
\f[C]
roles list [--user | --vault] [--json] [--limit <n>]
roles info <id>
roles info <name> [--user | --vault]
roles create <name> --type <user | vault> [--from <id | name>] [<permission_flags>]
roles update <id> [--name <new_name>] [<permission_flag>]
roles delete <id>
\f[R]
.fi
.PP
Create and manage \f[B]role templates\f[R].
There are two kinds: - \f[B]User roles\f[R] (global/admin scopes) -
\f[B]Vault roles\f[R] (per-vault access scopes)
.SS User-role permission flags
.PP
You can use the shorthand \f[V]--manage-*\f[R] to set a flag, or
\f[V]--set-*\f[R] / \f[V]--unset-*\f[R] explicitly.
.IP
.nf
\f[C]
--manage-encryption-keys   | --set-manage-encryption-keys   | --unset-manage-encryption-keys
--manage-admins            | --set-manage-admins            | --unset-manage-admins
--manage-users             | --set-manage-users             | --unset-manage-users
--manage-groups            | --set-manage-groups            | --unset-manage-groups
--manage-vaults            | --set-manage-vaults            | --unset-manage-vaults
--manage-roles             | --set-manage-roles             | --unset-manage-roles
--manage-api-keys          | --set-manage-api-keys          | --unset-manage-api-keys
--audit-log-access         | --set-audit-log-access         | --unset-audit-log-access
--create-vaults            | --set-create-vaults            | --unset-create-vaults
\f[R]
.fi
.RS
.PP
\f[B]Danger:\f[R] \f[V]--manage-encryption-keys\f[R] grants
export/rotation authority.
Assign with extreme caution.
.RE
.SS Vault-role permission flags
.PP
For per-vault access control:
.IP
.nf
\f[C]
--migrate-data
--manage-access
--manage-tags
--manage-metadata
--manage-versions
--manage-file-locks
--share
--sync
--create
--download
--delete
--rename
--move
--list
\f[R]
.fi
.PP
Each can be toggled with \f[V]--set-<flag>\f[R] /
\f[V]--unset-<flag>\f[R] or enabled via shorthand (e.g.,
\f[V]--share\f[R]).
.SS api-keys / api-key
.IP
.nf
\f[C]
api-keys [create | new] --name <name> --access <accessKey> --secret <secret> --region <region=auto> --endpoint <endpoint> --provider <provider>
api-keys [create | new] -n <name> -a <accessKey> -s <secret> -r <region=auto> -e <endpoint> -p <provider>
    provider options: [aws | cloudflare-r2 | wasabi | backblaze-b2 | digitalocean | minio | ceph | storj | other]
api-keys [delete | rm] <id>
api-keys [info | get] <id>
api-keys list [--json]
\f[R]
.fi
.PP
API keys can be referenced by name or ID when configuring S3-backed
vaults.
.SS sync
.IP
.nf
\f[C]
vh sync status
vh sync trigger
\f[R]
.fi
.PP
Display sync status or request a sync run.
.SS help / version
.IP \[bu] 2
\f[V]vh help\f[R] or \f[V]vh <command> --help\f[R] shows usage.
.IP \[bu] 2
\f[V]vh version\f[R] (or \f[V]-v\f[R], \f[V]--version\f[R]) prints
version details.
.SH EXAMPLES
.PP
Create a user and put them in a group:
.IP
.nf
\f[C]
vh user create --name \[dq]alice\[dq] --role \[dq]operator\[dq] --email \[dq]alice\[at]example.com\[dq] --linux-uid 1001
vh group create engineering --desc \[dq]Core eng\[dq]
vh group add-user engineering alice
\f[R]
.fi
.PP
Create an S3-backed vault and grant Alice read/list/share:
.IP
.nf
\f[C]
vh api-keys create --name r2-main --provider cloudflare-r2 --access ABC --secret DEF --endpoint https://<accid>.r2.cloudflarestorage.com --region auto
vh vault create team-archive --s3 --api-key r2-main --bucket team-archive \[rs]
  --sync-strategy cache --on-sync-conflict ask --desc \[dq]Team archive\[dq]

# Assume a vault role \[aq]reader\[aq] has flags: --list --download --share
vh roles info reader --vault
vh vault assign team-archive  <role_id_of_reader> --user alice --owner <owner_id_or_name>
\f[R]
.fi
.PP
Rotate keys for all vaults (admin-only):
.IP
.nf
\f[C]
vh vault keys rotate all
\f[R]
.fi
.PP
List roles as JSON (for scripting):
.IP
.nf
\f[C]
vh roles list --vault --json --limit 50
\f[R]
.fi
.SH BEHAVIOR & CONVENTIONS
.IP \[bu] 2
\f[B]IDs vs names:\f[R] Most commands accept either; \f[V]<id>\f[R] is
numeric; \f[V]<name>\f[R] is case-sensitive unless documented otherwise.
When a name is ambiguous, supply \f[V]--owner\f[R] (for vaults) or use
the numeric ID directly.
.IP \[bu] 2
\f[B]JSON output:\f[R] Listing commands (e.g., \f[V]roles list\f[R],
\f[V]api-keys list\f[R]) accept \f[V]--json\f[R] to produce
machine-readable output.
.IP \[bu] 2
\f[B]Quotas:\f[R] Sizes accept suffixes \f[V]T\f[R], \f[V]G\f[R],
\f[V]M\f[R], \f[V]B\f[R].
\f[V]unlimited\f[R] removes enforcement.
.SH SECURITY NOTES
.IP \[bu] 2
\f[B]Encryption key export:\f[R] \f[V]vault keys export\f[R] should be
restricted to super-admins.
If a non-super-admin holds \f[V]manage-encryption-keys\f[R], audit logs
will warn accordingly.
.IP \[bu] 2
\f[B]Least privilege:\f[R] Prefer narrowly-scoped vault roles over broad
user-role grants.
.IP \[bu] 2
\f[B]Sync conflicts:\f[R] Choose \f[V]ask\f[R] in high-risk environments
to avoid silent overwrites.
.SH FILES
.IP \[bu] 2
\f[V]/etc/vaulthalla/config.yaml\f[R] \[em] Main configuration file.
(If managed by the web UI, comments may be preserved/reinserted when
writing back.)
.SH EXIT STATUS
.PP
\f[V]vh\f[R] exits with status \f[V]0\f[R] on success and a non-zero
status on failure.
.SH SEE ALSO
.PP
\f[V]vaulthalla\f[R] daemon, system logs, project documentation.
.SH AUTHOR
.PP
Cooper Larson and the Vaulthalla contributors.
.SH AUTHORS
Cooper Larson.
